(review date: 05/05/2023)

## Mappings MedicinalProductDefinition

| Samv2 table | samv2 column        | MedicinalProductDefinition    | Info              |
|-------------|---------------------|-------------------------------|-------------------|
| AMP_FAHMP   | code                | identifier                    |                   |
| AMP_FAHMP   | officialName        | name                          |                   |
| AMP_FAHMP   | blackTriangle       | additionalMonitoringIndicator |                   |
| AMP_FAHMP   | companyActorNumber  |                               |                   |
| AMP_FAHMP   | medicineType        |                               |                   |
| AMP_FAHMP   | nameEng             | not used                      |                   |
| AMP_FAHMP   | nameFr              | not used                      |                   |
| AMP_FAHMP   | nameGer             | not used                      |                   |
| AMP_FAHMP   | nameNl              | not used                      |                   |
| AMP_FAHMP   | prescriptionNameEng | name                          |                   |
| AMP_FAHMP   | prescriptionNameFr  | name                          |                   |
| AMP_FAHMP   | prescriptionNameGer | name                          |                   |
| AMP_FAHMP   | prescriptionNameNl  | name                          |                   |
| AMP_FAHMP   | status              | **derived from validity**     |                   |
| AMP_FAHMP   | validFrom           |                               |                   |
| AMP_FAHMP   | validTo             |                               |                   |
| AMP_FAHMP   | vmpCode             |                               |                   |
|             |                     | type                          | Medicinal Product |
|             |                     | domain                        | Human             |
|             |                     | combined dose form            | not implemented   |
|             |                     | route                         | not implemented   |
|             |                     | indication                    | not implemented   |
|             |                     | legal status                  | not implemented   |
|             |                     | special measures              | not required      |
|             |                     | pediatric use indicator       | not provided      |
| AMPP_FAMHP  |                     | classification                | atc code          |

### Status

Status has three different options in Samv2 on the AMP level:

- Authorized
- Suspended
- Revoked

Initially, the feeling is that you could use the following valueset for the
status: https://hl7.org/fhir/R5/valueset-publication-status.html
A mapping could be:

- Authorized = active
- Suspended = draft
- Revoked = retired

We could have used revoked for suspended, but it feels right to set them to draft-mode when there are issues with
the medicine. Another option is to use 'authorized' for suspended, since these are still active.
An issue here is that the status-field in FHIR does not refer to the marketing-status. Therefor it seems a bit better to
derive the status from the validity.  
There are other options for the market-status:

A first option is a MarketingStatus. The 'status'-field here would
then line out the basic status of the FHIR document, where we keep active and retired. The marketingstatus would then
implement the three different samv2 status-options.

A second option is to use a RegulatedAuthorization that encompasses the authorization that authorized this medication.
This document can then link back to this Medication-resource.

## Fhir MedicinalProductDefinition Fields

[source](https://hl7.org/fhir/R5/medicinalproductdefinition.html)

## Not implemented
Not implemented in the above mapping table does not mean that the data is not available. It does mean that the mapping 
just hasn't been researched yet. 

## Issues

The levels look like they differ a bit. We might try to remap this on a package,
or we might grab some extra package-information like ATC to use in the global FHIR-
resource. The issue is that it looks like the models differ on the location where
they set the break-line on what medical information is, and what packaging information is.

## Versioning

It's pretty hard to translate these things into versions. This paragraph will outline the issue here.
FHIR documents seem to expect some kind of versioning like you version software, where you can get a 'rowversion'
of an object, and where the latest version is the newest version.

For versioning in the Samv2 world I'll attempt to use a timestamp as a version, and check against that
to fill in the different fields based on the samv2 data. This means that there is no real version for a
medication-field here, but that the content is provided by the datetime that is provided.

## Packaged product definition fields

| ID                                                                  | Path                                                                | mapped |
|:--------------------------------------------------------------------|:--------------------------------------------------------------------|:-------|
| PackagedProductDefinition                                           | PackagedProductDefinition                                           |        |
| PackagedProductDefinition.id                                        | PackagedProductDefinition.id                                        |        |
| PackagedProductDefinition.meta                                      | PackagedProductDefinition.meta                                      |        |
| PackagedProductDefinition.implicitRules                             | PackagedProductDefinition.implicitRules                             |        |
| PackagedProductDefinition.language                                  | PackagedProductDefinition.language                                  |        |
| PackagedProductDefinition.text                                      | PackagedProductDefinition.text                                      |        |
| PackagedProductDefinition.contained                                 | PackagedProductDefinition.contained                                 |        |
| PackagedProductDefinition.extension                                 | PackagedProductDefinition.extension                                 |        |
| PackagedProductDefinition.modifierExtension                         | PackagedProductDefinition.modifierExtension                         |        |
| PackagedProductDefinition.identifier                                | PackagedProductDefinition.identifier                                |        |
| PackagedProductDefinition.name                                      | PackagedProductDefinition.name                                      |        |
| PackagedProductDefinition.type                                      | PackagedProductDefinition.type                                      |        |
| PackagedProductDefinition.packageFor                                | PackagedProductDefinition.packageFor                                |        |
| PackagedProductDefinition.status                                    | PackagedProductDefinition.status                                    |        |
| PackagedProductDefinition.statusDate                                | PackagedProductDefinition.statusDate                                |        |
| PackagedProductDefinition.containedItemQuantity                     | PackagedProductDefinition.containedItemQuantity                     |        |
| PackagedProductDefinition.description                               | PackagedProductDefinition.description                               |        |
| PackagedProductDefinition.legalStatusOfSupply                       | PackagedProductDefinition.legalStatusOfSupply                       |        |
| PackagedProductDefinition.legalStatusOfSupply.id                    | PackagedProductDefinition.legalStatusOfSupply.id                    |        |
| PackagedProductDefinition.legalStatusOfSupply.extension             | PackagedProductDefinition.legalStatusOfSupply.extension             |        |
| PackagedProductDefinition.legalStatusOfSupply.modifierExtension     | PackagedProductDefinition.legalStatusOfSupply.modifierExtension     |        |
| PackagedProductDefinition.legalStatusOfSupply.code                  | PackagedProductDefinition.legalStatusOfSupply.code                  |        |
| PackagedProductDefinition.legalStatusOfSupply.jurisdiction          | PackagedProductDefinition.legalStatusOfSupply.jurisdiction          |        |
| PackagedProductDefinition.marketingStatus                           | PackagedProductDefinition.marketingStatus                           |        |
| PackagedProductDefinition.copackagedIndicator                       | PackagedProductDefinition.copackagedIndicator                       |        |
| PackagedProductDefinition.manufacturer                              | PackagedProductDefinition.manufacturer                              |        |
| PackagedProductDefinition.attachedDocument                          | PackagedProductDefinition.attachedDocument                          |        |
| PackagedProductDefinition.packaging                                 | PackagedProductDefinition.packaging                                 |        |
| PackagedProductDefinition.packaging.id                              | PackagedProductDefinition.packaging.id                              |        |
| PackagedProductDefinition.packaging.extension                       | PackagedProductDefinition.packaging.extension                       |        |
| PackagedProductDefinition.packaging.modifierExtension               | PackagedProductDefinition.packaging.modifierExtension               |        |
| PackagedProductDefinition.packaging.identifier                      | PackagedProductDefinition.packaging.identifier                      |        |
| PackagedProductDefinition.packaging.type                            | PackagedProductDefinition.packaging.type                            |        |
| PackagedProductDefinition.packaging.componentPart                   | PackagedProductDefinition.packaging.componentPart                   |        |
| PackagedProductDefinition.packaging.quantity                        | PackagedProductDefinition.packaging.quantity                        |        |
| PackagedProductDefinition.packaging.material                        | PackagedProductDefinition.packaging.material                        |        |
| PackagedProductDefinition.packaging.alternateMaterial               | PackagedProductDefinition.packaging.alternateMaterial               |        |
| PackagedProductDefinition.packaging.shelfLifeStorage                | PackagedProductDefinition.packaging.shelfLifeStorage                |        |
| PackagedProductDefinition.packaging.manufacturer                    | PackagedProductDefinition.packaging.manufacturer                    |        |
| PackagedProductDefinition.packaging.property                        | PackagedProductDefinition.packaging.property                        |        |
| PackagedProductDefinition.packaging.property.id                     | PackagedProductDefinition.packaging.property.id                     |        |
| PackagedProductDefinition.packaging.property.extension              | PackagedProductDefinition.packaging.property.extension              |        |
| PackagedProductDefinition.packaging.property.modifierExtension      | PackagedProductDefinition.packaging.property.modifierExtension      |        |
| PackagedProductDefinition.packaging.property.type                   | PackagedProductDefinition.packaging.property.type                   |        |
| PackagedProductDefinition.packaging.property.value[x]               | PackagedProductDefinition.packaging.property.value[x]               |        |
| PackagedProductDefinition.packaging.containedItem                   | PackagedProductDefinition.packaging.containedItem                   |        |
| PackagedProductDefinition.packaging.containedItem.id                | PackagedProductDefinition.packaging.containedItem.id                |        |
| PackagedProductDefinition.packaging.containedItem.extension         | PackagedProductDefinition.packaging.containedItem.extension         |        |
| PackagedProductDefinition.packaging.containedItem.modifierExtension | PackagedProductDefinition.packaging.containedItem.modifierExtension |        |
| PackagedProductDefinition.packaging.containedItem.item              | PackagedProductDefinition.packaging.containedItem.item              |        |
| PackagedProductDefinition.packaging.containedItem.amount            | PackagedProductDefinition.packaging.containedItem.amount            |        |
| PackagedProductDefinition.packaging.packaging                       | PackagedProductDefinition.packaging.packaging                       |        |
| PackagedProductDefinition.characteristic                            | PackagedProductDefinition.characteristic                            |        |
